// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  //User auth data
  id            Int       @id @default(autoincrement())
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  email         String    @unique
  hash          String?
  displayName   String?
  imageUrl      String?
  googleSecret  String?
  // add path of the image

  socketId       String?
  blockedUserIds     Int[]
  @@map("users")
}

model Channel{
  id                Int         @id @default(autoincrement())
  name              String
  mode              ChannelMode @default(PUBLIC)
  password          String      @default("")
  ownerId           Int?                                                                    //one  to many field
  adminIds          Int[]
  banedUserIds      Int[]
  banedRelease      DateTime[]
  //mutes             User[]      @relation("Mutes")                                          //many to many
  //messages          Message[]   @relation("Channel")                                        //one  to many
  messageIds        Int[]
  userIds           Int[]
  //@@map("channels")
}

model Message {
  id                Int         @id @default(autoincrement())
  text              String?
  //author            User        @relation("Author", fields: [authorId], references: [id])   //one  to many
  authorId          Int                                                                     //one  to many field
  //author            String?
  //channel           Channel     @relation("Channel", fields: [channelId], references: [id]) //one  to many
  //channelId         Int                                                                     //one  to many field
}

enum ChannelMode {
  PUBLIC                                                                                    //everybody can join
  DIRECT                                                                                    //direct messages between two users
  PRIVATE                                                                                   //new users must be invited by channel users (not clear in the subject)
  //PROTECTED                                                                                 //a password is set //This is just a pulic channel with password
}
